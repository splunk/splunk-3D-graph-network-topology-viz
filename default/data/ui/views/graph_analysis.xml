<form script="searchcontrolsevents.js" stylesheet="searchcontrolsevents.css" theme="dark" version="1.1">
  <init>
    <set token="show_results">true</set>
    <set token="beforeSearch">true</set>
  </init>
  <label>Graph Analysis Framework</label>
  <fieldset submitButton="false"></fieldset>
  <row>
    <panel>
      <html>
        <div class="ga_framework_intro">
          <p>This dashboard is designed to help you generate some graph analytics on your own data. The search bar can be used to input some base data and graph visuals can then be generated by selecting a source field (such as src_ip) as destination field (such as dest_ip) and a weight field (such as the count of connections between src_ip and dest_ip pairs).</p>
        </div>
      </html>
    </panel>
    <panel>
      <html>
        <div class="ga_framework_info">
          <h3>Eager to discover more?</h3>
          <p>Four dashboards are embedded to show graph algorithms in action using NetworkX. Select them by clicking on <code>Graph Examples</code> dropdown in the app navigation bar.</p>
          <p>More uses cases are described in Splunk Blogs posts:</p>
          <ul>
            <li>
              <a class="external" href="https://www.splunk.com/en_us/blog/machine-learning/chasing-a-hidden-gem-graph-analytics-with-splunk-s-machine-learning-toolkit.html">Chasing a Hidden Gem: Graph Analytics with Splunkâ€™s Machine Learning Toolkit</a>
            </li>
            <li>Understanding and baselining network behaviour [ <a class="external" href="https://www.splunk.com/en_us/blog/machine-learning/understanding-and-baselining-network-behaviour-using-machine-learning-part-i.html">part 1</a> | <a class="external" href="https://www.splunk.com/en_us/blog/machine-learning/understanding-and-baselining-network-behaviour-using-machine-learning-part-ii.html">part 2</a> ]</li>
          </ul>
        </div>
      </html>
    </panel>
    <panel depends="$alwaysHideThisPanel$">
      <input type="text" token="searchString">
        <label>$searchString$</label>
      </input>
    </panel>
  </row>
  <row>
    <panel depends="$beforeSearch$">
      <html>
        <div class="ga_framework_inputdata">
          <h1>1. Input Data</h1>
          <div>
            <p style="margin-bottom:0px;">Either run your own search or select one of the example options below, with the first option returning a selection of records from the <a class="external" href="https://www.hs-coburg.de/forschung/forschungsprojekte-oeffentlich/informationstechnologie/cidds-coburg-intrusion-detection-data-sets.html">Coburg Intrusion Detection Data Set (CIDDS)</a></p>
            <p> Once the search has run, select a source, destination and weight field to visualise the results.</p>
          </div>
          <button type="button" id="cidds" class="btn btn-primary">Populate Search with CIDDS Data</button>
          <button type="button" id="bitcoin" class="btn btn-primary">Populate Search with Bitcoin Data</button>
          <button type="button" id="internal" class="btn btn-primary">Populate Search with Internal Log Data</button>
        </div>
      </html>
    </panel>
  </row>
  <row>
    <panel>
      <html>
        <div>
            <div class="main-area">
                <div id="mysearchbar1"/>
                <div id="mysearchcontrols1"/>
            </div>
        </div>
      </html>
    </panel>
  </row>
  <row>
    <panel depends="$searchString$">
      <table>
        <title>Search results</title>
        <search base="base">
          <query>| table *</query>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
  <row>
    <panel depends="$searchString$">
      <html>
        <h1>2. Select Fields</h1>
      </html>
    </panel>
  </row>
  <row>
    <panel depends="$searchString$">
      <input type="dropdown" token="source">
        <label>Select Source Field:</label>
        <fieldForLabel>field</fieldForLabel>
        <fieldForValue>field</fieldForValue>
        <search base="base">
          <query>| table *
| fieldsummary
| table field
| dedup field</query>
        </search>
      </input>
      <input type="dropdown" token="destination">
        <label>Select Destination Field:</label>
        <fieldForLabel>field</fieldForLabel>
        <fieldForValue>field</fieldForValue>
        <search base="base">
          <query>| table *
| fieldsummary
| table field
| dedup field</query>
        </search>
      </input>
      <input type="dropdown" token="weight">
        <label>Select Weight Field:</label>
        <fieldForLabel>field</fieldForLabel>
        <fieldForValue>field</fieldForValue>
        <search base="base">
          <query>| table *
| fieldsummary
| search numeric_count&gt;0
| table field
| dedup field</query>
        </search>
      </input>
    </panel>
  </row>
  <row>
    <panel depends="$searchString$">
      <html>
        <h1>3. Visualise the Results</h1>
      </html>
    </panel>
  </row>
  <row>
    <panel depends="$source$,$destination$,$weight$,$searchString$">
      <viz type="splunk-3D-graph-network-topology-viz.3d_graph_network_topology_viz">
        <title>Simple graph visualisation based on the search results</title>
        <search base="base">
          <query>| table "$source$" "$destination$" "$weight$"</query>
        </search>
        <option name="drilldown">none</option>
        <option name="height">372</option>
      </viz>
    </panel>
  </row>
  <row>
    <panel depends="$source$,$destination$,$weight$,$searchString$">
      <html>
        <h1>4. Further Analysis</h1>
      </html>
    </panel>
  </row>
  <row>
    <panel depends="$source$,$destination$,$weight$,$searchString$">
      <table id="tb_centralitymeasures">
        <search>
          <query>| makeresults | fields - _time | eval text="Do you want to identify the most critical nodes in your network?" | rename text as "Centrality Measures"</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">cell</option>
        <option name="link.visible">false</option>
        <drilldown>
          <link target="_self">/app/splunk-3D-graph-network-topology-viz/graph_analysis_centrality?form.search=$searchString$&amp;form.source=$source$&amp;form.destination=$destination$&amp;form.weight=$weight$&amp;form.time.earliest=$earliest$&amp;form.time.latest=$latest$</link>
        </drilldown>
      </table>
      <html>
        <div style="text-align:center;">
          <div class="icon">
          
            <img src="/static/app/splunk-3D-graph-network-topology-viz/images/weighted.png" width="300" height="300"/>
          
          </div>
        </div>
      </html>
    </panel>
    <panel depends="$source$,$destination$,$weight$,$searchString$">
      <table id="tb_minspanningtree">
        <search>
          <query>| makeresults | fields - _time | eval text="Do you want to find the shortest path through your network?" | rename text as "Minimum Spanning Tree"</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">cell</option>
        <option name="link.visible">false</option>
        <drilldown>
          <link target="_self">/app/splunk-3D-graph-network-topology-viz/graph_analysis_minimum_spanning_tree?form.search=$searchString$&amp;form.source=$source$&amp;form.destination=$destination$&amp;form.weight=$weight$&amp;form.time.earliest=$earliest$&amp;form.time.latest=$latest$</link>
        </drilldown>
      </table>
      <html>
        <div style="text-align:center;">
          <div class="icon">
          
            <img src="/static/app/splunk-3D-graph-network-topology-viz/images/spine.png" width="300" height="300"/>
          
          </div>
        </div>
      </html>
    </panel>
    <panel depends="$source$,$destination$,$weight$,$searchString$">
      <table id="tb_conncomponents">
        <search>
          <query>| makeresults | fields - _time | eval text="Do you want to analyse the groups of connected nodes in your network?" | rename text as "Connected Components"</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">cell</option>
        <option name="link.visible">false</option>
        <drilldown>
          <link target="_self">/app/splunk-3D-graph-network-topology-viz/graph_analysis_connected_components?form.search=$searchString$&amp;form.source=$source$&amp;form.destination=$destination$&amp;form.weight=$weight$&amp;form.time.earliest=$earliest$&amp;form.time.latest=$latest$</link>
        </drilldown>
      </table>
      <html>
        <div style="text-align:center;">
          <div class="icon">
            
              <img src="/static/app/splunk-3D-graph-network-topology-viz/images/connected.png" width="300" height="300"/>
            
          </div>
        </div>
      </html>
    </panel>
    <panel depends="$source$,$destination$,$weight$,$searchString$">
      <table id="tb_communitydetection">
        <search>
          <query>| makeresults | fields - _time  | eval text="Do you want to analyse the groups of related nodes in your network?" | rename text as "Community Detection"</query>
          <earliest>$earliest$</earliest>
          <latest>$latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">cell</option>
        <option name="link.visible">false</option>
        <drilldown>
          <link target="_self">/app/splunk-3D-graph-network-topology-viz/graph_analysis_label_propagation?form.search=$searchString$&amp;form.source=$source$&amp;form.destination=$destination$&amp;form.weight=$weight$&amp;form.time.earliest=$earliest$&amp;form.time.latest=$latest$</link>
        </drilldown>
      </table>
      <html>
        <div style="text-align:center;">
          <div class="icon">
          
            <img src="/static/app/splunk-3D-graph-network-topology-viz/images/label.png" width="300" height="300"/>
          
          </div>
        </div>
      </html>
    </panel>
  </row>
</form>